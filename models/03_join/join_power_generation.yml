version: 2

models:
  - name: join_power_generation
    description: Joined fact table with unit and weather data at hourly granularity
    columns:
      - name: power_generation_id
        description: Unique identifier for each power generation reading
        tests:
          - unique
          - not_null

      - name: power_generation_unit_id
        description: Foreign key to power generation unit
        tests:
          - not_null
          - relationships:
              arguments:
                to: ref('clean_dim_unit')
                field: power_generation_unit_id

      - name: start_datetime
        description: Start timestamp of power generation period
        tests:
          - not_null

      - name: start_date
        description: Start date (without time) for daily aggregation
        tests:
          - not_null

      - name: duration_hours
        description: Duration of generation period in hours
        tests:
          - not_null

      - name: value_mw
        description: Power output in megawatts
        tests:
          - not_null

      - name: unit_name
        description: Name of the power generation unit

      - name: operator
        description: Company or entity operating the unit

      - name: unit_city
        description: City where the unit is located

      - name: unit_state
        description: German state (Bundesland) where the unit is located

      - name: energy_source
        description: Type of energy source (e.g., Natural Gas, Nuclear Energy, Water)
        tests:
          - not_null

      - name: is_storage
        description: Boolean flag indicating if this is a storage facility (true/false)

      - name: plant_status
        description: Current operational status (e.g., In operation, Temporarily shut down)

      - name: gross_capacity_mw
        description: Gross electrical capacity in megawatts (rated capacity)

      - name: net_electrical_capacity_mw
        description: Net electrical capacity in megawatts (available for grid export)
        tests:
          - not_null

      - name: energy_mwh
        description: Total energy generated (power * duration) in megawatt-hours
        tests:
          - not_null

      - name: capacity_utilization_percent
        description: Capacity utilization as percentage of net electrical capacity

      - name: weather_datetime
        description: Timestamp of weather observation matching the generation period

      - name: temperature_2m_c
        description: Temperature at 2 meters above ground in Celsius

      - name: wind_speed_10m_mps
        description: Wind speed at 10 meters height in meters per second

      - name: wind_speed_80m_mps
        description: Wind speed at 80 meters height in meters per second

      - name: shortwave_radiation_wpm2
        description: Total shortwave solar radiation in watts per square meter

      - name: direct_radiation_wpm2
        description: Direct solar radiation in watts per square meter

      - name: diffuse_radiation_wpm2
        description: Diffuse solar radiation in watts per square meter

      - name: precipitation_mm
        description: Total precipitation (rain + snow equivalent) in millimeters

      - name: cloud_cover_percent
        description: Cloud cover as percentage (0-100)

      - name: pressure_msl_hpa
        description: Atmospheric pressure at mean sea level in hectopascals

      - name: rain_mm
        description: Rainfall amount in millimeters

      - name: snowfall_cm
        description: Snowfall amount in centimeters
