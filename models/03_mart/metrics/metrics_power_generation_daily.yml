# =========================================
# DERIVED METRICS FOR SELF-SERVICE ANALYTICS
# =========================================
#
# These metrics provide high-level business KPIs calculated from
# the power_generation_daily semantic model measures.


metrics:
  - name: renewable_energy_share_pct
    description: |
      Renewable energy percentage of total generation.
      Calculated as: (Renewable Energy / Total Energy) × 100
      Tracks progress toward renewable energy targets and energy transition goals.
      Renewable sources include: Water, Biomass, Waste, Battery Storage, Pumped Storage.
    type: ratio
    label: Renewable Energy Share %
    type_params:
      numerator:
        name: total_energy_generated_mwh
        filter: "{{ Dimension('power_generation_daily__is_renewable') }} = True"
      denominator:
        name: total_energy_generated_mwh

  - name: avg_daily_energy_per_unit_mwh
    description: |
      Average daily energy production per unit.
      Calculated as: Total Energy Generated / Number of Units
      Useful for:
      - Benchmarking unit performance against peers
      - Identifying underperforming assets
      - Regional comparison (e.g., which states have highest avg daily per unit)
    type: ratio
    label: Avg Daily Energy per Unit (MWh)
    type_params:
      numerator:
        name: total_energy_generated_mwh
      denominator:
        name: unique_unit_count

  - name: load_factor_pct
    description: |
      Load factor percentage - ratio of average output to peak output.
      Calculated as: (Average Power Output / Peak Power Output) × 100
      High load factors (>70%) indicate consistent baseload generation (coal, nuclear, hydro).
      Low load factors (<30%) suggest peaking plants or highly variable renewables (solar, wind).
    type: ratio
    label: Load Factor %
    type_params:
      numerator:
        name: total_avg_power_output_mw
      denominator:
        name: total_max_power_output_mw

  - name: energy_intensity_mwh_per_mw
    description: |
      Energy intensity - total energy produced per MW of installed capacity.
      Calculated as: Total Energy (MWh) / Installed Capacity (MW)

      Higher values indicate better capacity utilization over time.
      Useful for:
      - Comparing efficiency across different energy sources and regions
      - Operator performance benchmarking
      - Investment return calculations
    type: ratio
    label: Energy Intensity (MWh/MW)
    type_params:
      numerator:
        name: total_energy_generated_mwh
      denominator:
        name: total_installed_capacity_mw
